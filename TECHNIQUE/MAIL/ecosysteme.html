
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://www.uepal.fr/TECHNIQUE/MAIL/ecosysteme.html">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-8.5.10">
    
    
      
        <title>Ecosystème - Documentation UEPAL Civiparoisse</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.975780f9.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.2505c338.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ecosysteme-des-mails-de-masse" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../index.html" title="Documentation UEPAL Civiparoisse" class="md-header__button md-logo" aria-label="Documentation UEPAL Civiparoisse" data-md-component="logo">
      
  <img src="../../assets/uepal-logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Documentation UEPAL Civiparoisse
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Ecosystème
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="switch to light mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="switch to light mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
            </label>
          
        
          
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../index.html" title="Documentation UEPAL Civiparoisse" class="md-nav__button md-logo" aria-label="Documentation UEPAL Civiparoisse" data-md-component="logo">
      
  <img src="../../assets/uepal-logo.svg" alt="logo">

    </a>
    Documentation UEPAL Civiparoisse
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../index.html" class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Présentation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Présentation" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Présentation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../PRESENTATION/index.html" class="md-nav__link">
        Introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../PRESENTATION/presentation_fonctionnelle.html" class="md-nav__link">
        Périmètre fonctionnel
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../PRESENTATION/presentation_ecosysteme.html" class="md-nav__link">
        Ecosystème projet
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../PRESENTATION/presentation_livrables.html" class="md-nav__link">
        Livrables
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Technique
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Technique" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Technique
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../roles.html" class="md-nav__link">
        Rôles
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2" type="checkbox" id="__nav_3_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3_2">
          Mail
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Mail" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          Mail
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="mail.html" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Ecosystème
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="ecosysteme.html" class="md-nav__link md-nav__link--active">
        Ecosystème
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#le-natif-existant" class="md-nav__link">
    Le natif existant
  </a>
  
    <nav class="md-nav" aria-label="Le natif existant">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ciblage-des-destinataires-smart-groups" class="md-nav__link">
    Ciblage des destinataires : smart groups
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#contenu-textuel-du-mail-de-masse-personnalisation" class="md-nav__link">
    Contenu textuel du mail de masse : personnalisation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mise-en-forme-de-mails-de-masse" class="md-nav__link">
    Mise en forme de mails de masse
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#integration-dimages" class="md-nav__link">
    Intégration d'images
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#urls-relatives-aux-mails" class="md-nav__link">
    URLs relatives aux mails
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sommes-de-controle" class="md-nav__link">
    Sommes de contrôle
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#informations-sur-lacces-au-contenu-lie" class="md-nav__link">
    Informations sur l'accès au contenu lié
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mailing-automation" class="md-nav__link">
    Mailing automation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lusage-et-les-adaptations-pour-civiparoisse" class="md-nav__link">
    L'usage et les adaptations pour Civiparoisse
  </a>
  
    <nav class="md-nav" aria-label="L'usage et les adaptations pour Civiparoisse">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lusage-specifique-des-mails-de-masse" class="md-nav__link">
    L'usage spécifique des mails de masse
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#les-mails-generes-multipartalternative-avec-texthtml-et-textplain" class="md-nav__link">
    Les mails générés : multipart/alternative, avec text/html et text/plain
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#les-images-stockees-sur-un-serveur-tiers" class="md-nav__link">
    Les images : stockées sur un serveur tiers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tracking" class="md-nav__link">
    Tracking
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mail-automation" class="md-nav__link">
    Mail automation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elements-hypothetiquement-utiles-pour-le-futur" class="md-nav__link">
    Eléments hypothétiquement utiles pour le futur
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="sendmail.html" class="md-nav__link">
        Envoi
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="fetchmail.html" class="md-nav__link">
        Réception
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_3" type="checkbox" id="__nav_3_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_3">
          Logiciel
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Logiciel" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_3">
          <span class="md-nav__icon md-icon"></span>
          Logiciel
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../LOGICIEL/index.html" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../LOGICIEL/distribution_code_composer.html" class="md-nav__link">
        Distribution de code
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../LOGICIEL/environnement_dev.html" class="md-nav__link">
        Environnement de dev
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../LOGICIEL/environnement_dev_env.html" class="md-nav__link">
        Personnalisation environnement de dev
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../LOGICIEL/importation.html" class="md-nav__link">
        Importation de données
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_4" type="checkbox" id="__nav_3_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_4">
          Intégration
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Intégration" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_4">
          <span class="md-nav__icon md-icon"></span>
          Intégration
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../INTEGRATION/index.html" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../INTEGRATION/etude_authentification.html" class="md-nav__link">
        Authentification
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_4_3" type="checkbox" id="__nav_3_4_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_4_3">
          Docker
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Docker" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_4_3">
          <span class="md-nav__icon md-icon"></span>
          Docker
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../INTEGRATION/docker.html" class="md-nav__link">
        Description générale
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_4_3_2" type="checkbox" id="__nav_3_4_3_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_4_3_2">
          Images
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Images" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_4_3_2">
          <span class="md-nav__icon md-icon"></span>
          Images
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../INTEGRATION/DOCKER/composer_base.html" class="md-nav__link">
        Composer_base
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../INTEGRATION/DOCKER/composer_files.html" class="md-nav__link">
        Composer_files
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../INTEGRATION/DOCKER/tools.html" class="md-nav__link">
        tools
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../INTEGRATION/DOCKER/init.html" class="md-nav__link">
        init
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../INTEGRATION/DOCKER/cron.html" class="md-nav__link">
        cron
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../INTEGRATION/DOCKER/selfkeys.html" class="md-nav__link">
        selfkeys
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../INTEGRATION/DOCKER/httpd.html" class="md-nav__link">
        httpd
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../INTEGRATION/DOCKER/authenticator.html" class="md-nav__link">
        authenticator
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../INTEGRATION/DOCKER/proxy.html" class="md-nav__link">
        proxy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../INTEGRATION/DOCKER/db_tls_server.html" class="md-nav__link">
        db_tls_server
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../INTEGRATION/DOCKER/db_tls_client.html" class="md-nav__link">
        db_tls_client
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../INTEGRATION/DOCKER/update.html" class="md-nav__link">
        update
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../INTEGRATION/db_ssl.html" class="md-nav__link">
        DB_SSL
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_4_5" type="checkbox" id="__nav_3_4_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_4_5">
          Kubernetes
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Kubernetes" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_4_5">
          <span class="md-nav__icon md-icon"></span>
          Kubernetes
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../INTEGRATION/KUBERNETES/maquettage.html" class="md-nav__link">
        Maquettage
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../INTEGRATION/KUBERNETES/ressources.html" class="md-nav__link">
        Ressources utiles
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_4_5_3" type="checkbox" id="__nav_3_4_5_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3_4_5_3">
          Chart Helm
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Chart Helm" data-md-level="4">
        <label class="md-nav__title" for="__nav_3_4_5_3">
          <span class="md-nav__icon md-icon"></span>
          Chart Helm
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../INTEGRATION/KUBERNETES/HELM/description_generale.html" class="md-nav__link">
        Description générale
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../INTEGRATION/KUBERNETES/HELM/db_dbproxy.html" class="md-nav__link">
        DB et DB proxy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../INTEGRATION/KUBERNETES/HELM/httpd.html" class="md-nav__link">
        Serveur web interne
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../INTEGRATION/KUBERNETES/HELM/proxy_auth.html" class="md-nav__link">
        Proxy et authenticateur
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../INTEGRATION/KUBERNETES/HELM/cron.html" class="md-nav__link">
        Cron
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../INTEGRATION/KUBERNETES/HELM/volumes.html" class="md-nav__link">
        Volumes (persistants)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../INTEGRATION/KUBERNETES/HELM/secrets.html" class="md-nav__link">
        Secrets
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../INTEGRATION/KUBERNETES/HELM/reservations.html" class="md-nav__link">
        Réservations
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#le-natif-existant" class="md-nav__link">
    Le natif existant
  </a>
  
    <nav class="md-nav" aria-label="Le natif existant">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ciblage-des-destinataires-smart-groups" class="md-nav__link">
    Ciblage des destinataires : smart groups
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#contenu-textuel-du-mail-de-masse-personnalisation" class="md-nav__link">
    Contenu textuel du mail de masse : personnalisation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mise-en-forme-de-mails-de-masse" class="md-nav__link">
    Mise en forme de mails de masse
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#integration-dimages" class="md-nav__link">
    Intégration d'images
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#urls-relatives-aux-mails" class="md-nav__link">
    URLs relatives aux mails
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sommes-de-controle" class="md-nav__link">
    Sommes de contrôle
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#informations-sur-lacces-au-contenu-lie" class="md-nav__link">
    Informations sur l'accès au contenu lié
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mailing-automation" class="md-nav__link">
    Mailing automation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lusage-et-les-adaptations-pour-civiparoisse" class="md-nav__link">
    L'usage et les adaptations pour Civiparoisse
  </a>
  
    <nav class="md-nav" aria-label="L'usage et les adaptations pour Civiparoisse">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lusage-specifique-des-mails-de-masse" class="md-nav__link">
    L'usage spécifique des mails de masse
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#les-mails-generes-multipartalternative-avec-texthtml-et-textplain" class="md-nav__link">
    Les mails générés : multipart/alternative, avec text/html et text/plain
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#les-images-stockees-sur-un-serveur-tiers" class="md-nav__link">
    Les images : stockées sur un serveur tiers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tracking" class="md-nav__link">
    Tracking
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mail-automation" class="md-nav__link">
    Mail automation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elements-hypothetiquement-utiles-pour-le-futur" class="md-nav__link">
    Eléments hypothétiquement utiles pour le futur
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="ecosysteme-des-mails-de-masse">Ecosystème des mails de masse</h1>
<p>Les mails de masse sont des outils de communication qui sont permis et supportés par un certain nombre de techniques complémentaires, dont une partie dépend de l'intégration technique de CiviCRM, et du périmètre fonctionnel retenu dans le cadre du projet. Il est donc intéressant de faire d'abord un état des lieux des fonctionnalités natives proposées par CiviCRM, avant de voir l'usage souhaité et les adaptations requises.</p>
<h2 id="le-natif-existant">Le natif existant</h2>
<h3 id="ciblage-des-destinataires-smart-groups">Ciblage des destinataires : smart groups</h3>
<p>Il est important que le mail soit pertinent pour ses destinataires. De ce fait, on cherchera à identifier ces personnes en se basant sur des critères se basant sur les données stockées dans CiviCRM.</p>
<p>Pour identifier les destinataires, une possibilité est de créer des groupes, voire des groupes dynamiques (smart groups : <a href="https://docs.civicrm.org/user/fr/latest/organising-your-data/smart-groups/">https://docs.civicrm.org/user/fr/latest/organising-your-data/smart-groups/</a>). L'intérêt des groupes dynamiques est que l'on peut recalculer les destinataires, et ainsi mettre à jour les destinataires.</p>
<h3 id="contenu-textuel-du-mail-de-masse-personnalisation">Contenu textuel du mail de masse : personnalisation</h3>
<p>Le mail de masse est envoyé à un grand nombre de personnes, ce qui est une forme de communication différente que les communications d'une personne à une unique autre ; ce sujet peut donc nécessiter une formation spécifique.</p>
<p>Même si le mail de masse s'adresse à un grand nombre, un certain degré de personnalisation du mail peut aider à renforcer l'intérêt du destinataire pour le mail. A cet effet, CiviCRM prévoit un mécanisme de tokens pour injecter des données personnalisées dans les mails. On retrouve par exemple des données sur l'instance CiviCRM elle-même, mais également des données relatives au contact (par exemple, nom, prénom...).</p>
<p><strong>Même si la personnalisation cherche à renforcer le lien avec l'utilisateur, il ne faut pas oublier que les mails circulent la plupart du temps dans un format déchiffrable au niveau d'un noeud de transport (notamment MTA ou MDA). On peut donc supposer qu'il est préférable de ne pas inclure des données sensibles dans les mails. Toutefois, il est à remarquer que des données sensibles peuvent parfois être déduites du fait de l'envoi d'un mail sur un sujet particulier...</strong></p>
<h3 id="mise-en-forme-de-mails-de-masse">Mise en forme de mails de masse</h3>
<p>Les mails sont généralement transmissibles au niveau des mails de masse de CiviCRM peuvent être sous deux formes :</p>
<ul>
<li>texte brut : dans ce mode, seul, éventuellement, des éléments comme les retours à la ligne et l'ascii-art peuvent intervenir dans la mise en forme au niveau de l'expéditeur. Ce mode d'envoi à l'intérêt d'être très simple, très léger, et permet de se concentrer sur le contenu rédactionnel, et devrait être utilisable dans la plupart des clients mails. Toutefois, le texte brut présente l'inconvénient de ne pas véhiculer facilement des éléments significatifs relatifs à l'identité numérique d'une entité (logo/images, charte graphique), et  ne fournit pas nativement de liens vers des éléments extérieurs qui sont utilisables par exemple pour les statistiques des mails</li>
<li>
<p>format html : grâce aux liens vers des éléments externes, on peut incorporer au mail des images, on peut véhiculer dans une certaine mesure une charte graphique via des styles CSS, on peut tenter d'obtenir des statistiques d'ouverture des mails, voire même de déterminer les éléments qui ont déclenché le plus de clics utilisateurs dans le mail. Toutefois, le format html est difficile à mettre en oeuvre, notamment en raison des différences plus que notables de présentation des mails en fonction des clients mails utilisés (clients lourds, interface webmail, interface en mode texte pour ne citer qu'eux). Ces différences ont conduit à l'adoption de pratiques particulières pour chercher à obtenir un rendu acceptable pour le plus grand nombre. On trouve des conseils sur des sites d'acteurs spécialisés comme : </p>
</li>
<li>
<p><a href="https://www.caniemail.com/">https://www.caniemail.com/</a> : Can I email : ce site est le pendant pour les mails de <a href="https://caniuse.com/">https://caniuse.com/</a>, et présente la compatibilité de techniques par rapport aux clients mails</p>
</li>
<li><a href="https://www.litmus.com/resources/">https://www.litmus.com/resources/</a> : Litmus</li>
<li><a href="https://www.emailonacid.com/white-papers/">https://www.emailonacid.com/white-papers/</a> : Email on Acid</li>
<li><a href="https://www.sarbacane.com/email-marketing/comment-faire">https://www.sarbacane.com/email-marketing/comment-faire</a> : Sarbacane (peut proposer des prestations de formation)</li>
<li><a href="https://mosaico.io/">https://mosaico.io/</a> : Mosaico : logiciel d'interface utilisateur pour simplifier la mise en forme des mails, en partant de modèles (templates) préconçus</li>
<li><a href="https://www.phplist.org/manual/books/phplist-manual/page/targeting-your-campaigns">https://www.phplist.org/manual/books/phplist-manual/page/targeting-your-campaigns</a> : phpList : choix des destinataires</li>
</ul>
<p>En ce qui concerne la mise en forme HTML, en plus de la littérature qui décrit les pratiques employées par certains professionnels, on peut constater qu'il existerait des outils CSS spécialisés, tels que :</p>
<ul>
<li><a href="https://bootstrapemail.com/">https://bootstrapemail.com/</a></li>
<li><a href="https://get.foundation/emails.html">https://get.foundation/emails.html</a> : Framework foundation pour les mails</li>
</ul>
<p>Etant donné la difficulté de créer des mails adaptés ex nihilo, il semble judicieux de partir d'un template (soit un fourni par Mosaico, soit un qui sera crée à partir d'un framework CSS pour les mails) que l'on intègrera à Mosaico. Le passage par Mosaico permet de fournir une interface utilisateur simplifiée qui permet à l'utilisateur de ne pas avoir à écrire directement du HTML si ce n'est pas ce qu'il souhaite faire. Si un utilisateur souhaite écrire du code HTML, l'interface lui en laisse toutefois la possibilité.</p>
<p>L'utilisation de ces outils n'est toutefois pas un gage de réussite, car le sujet reste malgré tout complexe.</p>
<p>Il est à noter que les templates CiviCRM et Mosaico sont différents : les templates CiviCRM peuvent contenir trois sections (header, body, footer), tandis que les templates Mosaico forcent le header et footer à null, pour tout travailler au niveau du body.</p>
<h3 id="integration-dimages">Intégration d'images</h3>
<p>L'intégration d'images dans un mail devra très probablement passer par le stockage des fichiers images sur un serveur de médias, accessible sans authentification. Un type d'images un peu particulier que l'on trouve dans certains mails est l'image d'un pixel transparent : l'intérêt de cette image est que si son URL est paramétrée et personnalisée dans chaque mail, on peut obtenir des estimations sur le nombre d'ouvertures du mail.</p>
<p>Au niveau de CiviCRM, on peut spécifier un répertoire pour les fichiers d'images, ainsi qu'une URL spécifique. Toutefois, on a tout intérêt à définir ces indications dès l'installation, et on a intérêt à passer ce serveur en HTTPS, en raison de l'accès à CiviCRM qui devra se faire depuis HTTPS - sans quoi les navigateurs refuseront de charger les ressources.</p>
<p>Etant donné que CiviCRM vérifie qu'il a le droit d'accéder au répertoire des images en écriture, et que l'intégration des images concerne bien plus que les images de la gallerie de Mosaico, il est improbable de pouvoir rajouter simplement des images venant d'un serveur distant. Si l'on souhaite intégrer des images venant de serveur tiers, il faudra intégrer manuellement les images via du code HTML.</p>
<p>Toutefois, on peut comprendre l'approche de considérer que les images sont stockées sur le serveur local : en effet, les images peuvent être redimenssionnées par rapport à leur taille d'utilisation, en tenant compte d'élements tels que la configuration liée aux écrans de type Retina, qui demandent des résolutions plus élevées.</p>
<h3 id="urls-relatives-aux-mails">URLs relatives aux mails</h3>
<p>On retrouve plusieurs types d'URLs qui vont avoir trait aux mails :</p>
<ul>
<li>url vers un pixel transparent pour les statistiques</li>
<li>urls d'action (unsubscribe, optout,resubscribe, welcome...)</li>
<li>url de ressources tierces (images notamment)</li>
<li>urls de redirection vers des contenus (avec comptabilisation des actions)</li>
</ul>
<p>Certaines de ces URL vont avoir des éléments spécifiques dans leur query string : des checksums et des informations sur des envent_queue. </p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="k">describe</span><span class="w"> </span><span class="n">civicrm_mailing_event_queue</span><span class="p">;</span><span class="w"></span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="o">+</span><span class="c1">------------+--------------+------+-----+---------+----------------+</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="o">|</span><span class="w"> </span><span class="n">Field</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="k">Type</span><span class="w">         </span><span class="o">|</span><span class="w"> </span><span class="k">Null</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">Key</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">Default</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Extra</span><span class="w">          </span><span class="o">|</span><span class="w"></span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="o">+</span><span class="c1">------------+--------------+------+-----+---------+----------------+</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="o">|</span><span class="w"> </span><span class="n">id</span><span class="w">         </span><span class="o">|</span><span class="w"> </span><span class="nb">int</span><span class="w"> </span><span class="n">unsigned</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">NO</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="n">PRI</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">NULL</span><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="n">auto_increment</span><span class="w"> </span><span class="o">|</span><span class="w"></span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="o">|</span><span class="w"> </span><span class="n">job_id</span><span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="nb">int</span><span class="w"> </span><span class="n">unsigned</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">NO</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="n">MUL</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">NULL</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"></span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="o">|</span><span class="w"> </span><span class="n">email_id</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="nb">int</span><span class="w"> </span><span class="n">unsigned</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">YES</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">MUL</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">NULL</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"></span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="o">|</span><span class="w"> </span><span class="n">contact_id</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nb">int</span><span class="w"> </span><span class="n">unsigned</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">NO</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="n">MUL</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">NULL</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"></span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="o">|</span><span class="w"> </span><span class="n">hash</span><span class="w">       </span><span class="o">|</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">NO</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="n">MUL</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">NULL</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"></span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="o">|</span><span class="w"> </span><span class="n">phone_id</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="nb">int</span><span class="w"> </span><span class="n">unsigned</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">YES</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">MUL</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">NULL</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"></span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="o">+</span><span class="c1">------------+--------------+------+-----+---------+----------------+</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="mi">6</span><span class="w"> </span><span class="k">rows</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="k">set</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">02</span><span class="w"> </span><span class="n">sec</span><span class="p">)</span><span class="w"></span>
</code></pre></div>
<h3 id="sommes-de-controle">Sommes de contrôle</h3>
<p>On retrouve plusieurs types de sommes de contrôle, qui sont liés à des "hashs". Même si les valeurs sont appelées hashs, ce ne sont pas forcément des hashs, plutôt des valeurs plus ou moins aléatoires. Un but de ces sommes de contrôle est de se protéger dans une certaine mesure de la forge d'URLs.</p>
<ul>
<li>
<p>hash sur un contact : ce champ peut être utilisé dans le cadre d'un checksum, dans la création d'une signature "façon HMAC", qui inclut en particulier le hash (secret), l'id du contact, l'heure de signature, et la durée de validité du checksum. Le hash étant secret, et les autres valeurs étant données dans la query string, il est possible de recalculer le hash et de vérifier si les champs entrant en jeu dans la signature ont été altérés</p>
</li>
<li>
<p>hash sur un mailing : ce champ est parfois rajouté directement dans une URL pour confirmer/remplacer l'identité du mailing que l'on souhaite accéder : le hash étant une valeur aléatoire, il y a certes un risque de collision, mais cette manière de faire permet d'éviter de pouvoir boucler sur des mails</p>
</li>
<li>
<p>hash sur un event queue : il incluerait le job_id, le contact_id et l'email_id, auquel on concatène le temps (fonction time()). Etant donné que le temps n'est pas sauvegardé, on ne peut pas recalculer cette somme de contrôle. On peut en revanche vérifier selon le stockage si c'est bien la valeur attendue, de manière analogue au hash de mailing.</p>
</li>
</ul>
<p>On constate donc qu'un champ de même nom peut être utilisé différemment en fonctions des tables. C'est un élément quelque peu déroutant.</p>
<h3 id="informations-sur-lacces-au-contenu-lie">Informations sur l'accès au contenu lié</h3>
<p>CiviCRM dispose nativement de la possibilité de remplacer des URL d'éléments par des redirections générées et stockées en local. L'intérêt de cette technique est que l'on peut ainsi obtenir une sorte de retour sur les éléments qui fonctionnent dans un mail.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="n">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="k">describe</span><span class="w"> </span><span class="n">civicrm_mailing_trackable_url</span><span class="p">;</span><span class="w"></span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="o">+</span><span class="c1">------------+--------------+------+-----+---------+----------------+</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="o">|</span><span class="w"> </span><span class="n">Field</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="k">Type</span><span class="w">         </span><span class="o">|</span><span class="w"> </span><span class="k">Null</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">Key</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">Default</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Extra</span><span class="w">          </span><span class="o">|</span><span class="w"></span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="o">+</span><span class="c1">------------+--------------+------+-----+---------+----------------+</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="o">|</span><span class="w"> </span><span class="n">id</span><span class="w">         </span><span class="o">|</span><span class="w"> </span><span class="nb">int</span><span class="w"> </span><span class="n">unsigned</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">NO</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="n">PRI</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">NULL</span><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="n">auto_increment</span><span class="w"> </span><span class="o">|</span><span class="w"></span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="o">|</span><span class="w"> </span><span class="n">url</span><span class="w">        </span><span class="o">|</span><span class="w"> </span><span class="nb">text</span><span class="w">         </span><span class="o">|</span><span class="w"> </span><span class="k">NO</span><span class="w">   </span><span class="o">|</span><span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="k">NULL</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"></span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="o">|</span><span class="w"> </span><span class="n">mailing_id</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nb">int</span><span class="w"> </span><span class="n">unsigned</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">NO</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="n">MUL</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">NULL</span><span class="w">    </span><span class="o">|</span><span class="w">                </span><span class="o">|</span><span class="w"></span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="o">+</span><span class="c1">------------+--------------+------+-----+---------+----------------+</span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="mi">3</span><span class="w"> </span><span class="k">rows</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="k">set</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">01</span><span class="w"> </span><span class="n">sec</span><span class="p">)</span><span class="w"></span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="n">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="k">describe</span><span class="w"> </span><span class="n">civicrm_mailing_event_trackable_url_open</span><span class="p">;</span><span class="w"></span>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="o">+</span><span class="c1">------------------+--------------+------+-----+-------------------+-------------------+</span>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a><span class="o">|</span><span class="w"> </span><span class="n">Field</span><span class="w">            </span><span class="o">|</span><span class="w"> </span><span class="k">Type</span><span class="w">         </span><span class="o">|</span><span class="w"> </span><span class="k">Null</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">Key</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">Default</span><span class="w">           </span><span class="o">|</span><span class="w"> </span><span class="n">Extra</span><span class="w">             </span><span class="o">|</span><span class="w"></span>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a><span class="o">+</span><span class="c1">------------------+--------------+------+-----+-------------------+-------------------+</span>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a><span class="o">|</span><span class="w"> </span><span class="n">id</span><span class="w">               </span><span class="o">|</span><span class="w"> </span><span class="nb">int</span><span class="w"> </span><span class="n">unsigned</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">NO</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="n">PRI</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">NULL</span><span class="w">              </span><span class="o">|</span><span class="w"> </span><span class="n">auto_increment</span><span class="w">    </span><span class="o">|</span><span class="w"></span>
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a><span class="o">|</span><span class="w"> </span><span class="n">event_queue_id</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="nb">int</span><span class="w"> </span><span class="n">unsigned</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">NO</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="n">MUL</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">NULL</span><span class="w">              </span><span class="o">|</span><span class="w">                   </span><span class="o">|</span><span class="w"></span>
<a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a><span class="o">|</span><span class="w"> </span><span class="n">trackable_url_id</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nb">int</span><span class="w"> </span><span class="n">unsigned</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">NO</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="n">MUL</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">NULL</span><span class="w">              </span><span class="o">|</span><span class="w">                   </span><span class="o">|</span><span class="w"></span>
<a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a><span class="o">|</span><span class="w"> </span><span class="n">time_stamp</span><span class="w">       </span><span class="o">|</span><span class="w"> </span><span class="k">timestamp</span><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="k">NO</span><span class="w">   </span><span class="o">|</span><span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">DEFAULT_GENERATED</span><span class="w"> </span><span class="o">|</span><span class="w"></span>
<a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a><span class="o">+</span><span class="c1">------------------+--------------+------+-----+-------------------+-------------------+</span>
<a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a><span class="mi">4</span><span class="w"> </span><span class="k">rows</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="k">set</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">01</span><span class="w"> </span><span class="n">sec</span><span class="p">)</span><span class="w"></span>
</code></pre></div>
<h3 id="mailing-automation">Mailing automation</h3>
<p>Le mailing automation est une fonctionnalité qui permet de déclencher des mails (réponses à des évènements). La source de l'évènement peut être un mail de retour avec des champs VERP, ou la consultation d'une URL spécifique.
CiviCRM peut alors envoyer un mail particulier en réponse à l'évènement, en fonction de sa configuration. Des templates spécifiques sont prévus en fonction des cas.</p>
<p>Dans <code>CRM_Core_SelectValues</code> :</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="x">  public static function mailingComponents() {</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="x">    return [</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="x">      &#39;Header&#39; =&gt; ts(&#39;Header&#39;),</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="x">      &#39;Footer&#39; =&gt; ts(&#39;Footer&#39;),</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="x">      &#39;Reply&#39; =&gt; ts(&#39;Reply Auto-responder&#39;),</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="x">      &#39;OptOut&#39; =&gt; ts(&#39;Opt-out Message&#39;),</span>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="x">      &#39;Subscribe&#39; =&gt; ts(&#39;Subscription Confirmation Request&#39;),</span>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="x">      &#39;Welcome&#39; =&gt; ts(&#39;Welcome Message&#39;),</span>
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="x">      &#39;Unsubscribe&#39; =&gt; ts(&#39;Unsubscribe Message&#39;),</span>
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a><span class="x">      &#39;Resubscribe&#39; =&gt; ts(&#39;Resubscribe Message&#39;),</span>
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a><span class="x">    ];</span>
<a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a><span class="x">  }</span>
</code></pre></div>
<p>Et également dans <code>CRM_Core_SelectValues</code> :</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="x">  public static function mailingTokens() {</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="x">    return [</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="x">      &#39;{action.unsubscribe}&#39; =&gt; ts(&#39;Unsubscribe via email&#39;),</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="x">      &#39;{action.unsubscribeUrl}&#39; =&gt; ts(&#39;Unsubscribe via web page&#39;),</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="x">      &#39;{action.resubscribe}&#39; =&gt; ts(&#39;Resubscribe via email&#39;),</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="x">      &#39;{action.resubscribeUrl}&#39; =&gt; ts(&#39;Resubscribe via web page&#39;),</span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="x">      &#39;{action.optOut}&#39; =&gt; ts(&#39;Opt out via email&#39;),</span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="x">      &#39;{action.optOutUrl}&#39; =&gt; ts(&#39;Opt out via web page&#39;),</span>
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="x">      &#39;{action.forward}&#39; =&gt; ts(&#39;Forward this email (link)&#39;),</span>
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="x">      &#39;{action.reply}&#39; =&gt; ts(&#39;Reply to this email (link)&#39;),</span>
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a><span class="x">      &#39;{action.subscribeUrl}&#39; =&gt; ts(&#39;Subscribe via web page&#39;),</span>
<a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a><span class="x">      &#39;{mailing.key}&#39; =&gt; ts(&#39;Mailing key&#39;),</span>
<a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a><span class="x">      &#39;{mailing.name}&#39; =&gt; ts(&#39;Mailing name&#39;),</span>
<a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a><span class="x">      &#39;{mailing.group}&#39; =&gt; ts(&#39;Mailing group&#39;),</span>
<a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a><span class="x">      &#39;{mailing.viewUrl}&#39; =&gt; ts(&#39;Mailing permalink&#39;),</span>
<a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a><span class="x">    ] + self::domainTokens();</span>
<a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a><span class="x">  }</span>
</code></pre></div>
<h2 id="lusage-et-les-adaptations-pour-civiparoisse">L'usage et les adaptations pour Civiparoisse</h2>
<p>Une caractéristique fondamentale de Civiparoisse est que l'ensemble des accès au coeur du système sont authentifiés. Cette caractéristique doit perdurer pour que le système reste conceptuellement simple. Or, on constate que les interactions entre les mails et l'environnement sont potentiellement fortes, ce qui complique les choses. Des compromis doivent donc être trouvés.</p>
<h3 id="lusage-specifique-des-mails-de-masse">L'usage spécifique des mails de masse</h3>
<p>La mise en oeuvres de mails de masse est différente des mails envoyés de personne à personne, et de ce fait, on peut supposer qu'une <strong>formation spécifique</strong> soit prodiguée aux utilisateurs.</p>
<h3 id="les-mails-generes-multipartalternative-avec-texthtml-et-textplain">Les mails générés : multipart/alternative, avec text/html et text/plain</h3>
<p>Mosaico semble fournir un intérêt pour la mise en oeuvre des mails, car il limite les risques de casse involontaire des mails. Il semble donc intéressant de privilégier l'utilisation de cet outil.</p>
<p>Les mails qui sont générés par le système sont déjà prévus pour être à la fois en html et en text/plain. De son côté, un Mail User Agent va privilégier l'affichage d'un seul rendu (celui qu'il est sensé comprendre, de plus grande préférence), et l'utilisateur n'est pas forcément au courant qu'il dispose dans le mail de plusieurs versions du contenu, dont une en texte brut. Au lieu de faire un lien vers une page web, il serait plus intéressant de faire remarquer à l'utilisateur que s'il a du mal à lire le mail, qu'il cherche à changer de source de message, ou d'afficher la source du mail (puisqu'une version est du texte brut).</p>
<p>En revanche, il conviendra éventuellement de laisser l'utilisateur préparer manuellement la version textuelle du mail, car cette version simplifiée ne correspond pas forcément à la version graphique, pour que le mail reste le plus lisible possible. </p>
<p><strong>On devra donc adapter les interfaces de l'adaptateur de mosaico à cet effet.</strong></p>
<h3 id="les-images-stockees-sur-un-serveur-tiers">Les images : stockées sur un serveur tiers</h3>
<p>La philosophie de l'adaptateur de Mosaico est de stocker les images sur le serveur local, en générant des versions à des tailles adaptées aux mails générés. On comprend donc l'intérêt de ce fonctionnement, mais il ne peut pas s'appliquer dans Civiparoisse. </p>
<p><strong>La meilleure solution est de stocker les images sur un serveur tiers, et de développer un bloc Mosaico pour cet usage, en sensibilisant les utilisateurs aux problématiques relatives aux images, de sorte à ce qu'ils optimisent eux-mêmes les médias qu'ils souhaitent utiliser. </strong></p>
<h3 id="tracking">Tracking</h3>
<p>Le tracking proposé par CiviCRM est certes utilisé dans le monde de l'entreprise, mais il est fait d'une manière quelque peu cachée, qui est au minimum questionnable dans le cadre d'une paroisse et de ses valeurs. Il semble donc peu approprié d'utiliser le tracking d'ouverture du mail tel que proposé nativement, et encore moins le tracking de contenu.</p>
<p>Toutefois, des statistiques d'utilisation semblent être les bienvenues. On se souviendra à cette fin qu'il existe le système appelé  <strong>Message Disposition Notification</strong> <a href="https://www.rfc-editor.org/rfc/rfc8098">RFC 8098</a>, qui peut demander des notifications par rapport au suivi du mail. Un tel retour sera probablement faible, mais il aura l'avantage d'être plus transparent par rapport à l'utilisateur, et pourra éventuellement même fournir des informations sur les Mail User Agent utilisés.</p>
<p><strong> Il faudra donc implémenter la demande de notifications MDN. </strong></p>
<h3 id="mail-automation">Mail automation</h3>
<p>Le mail automation permet surtout de générer une réaction suite à un clic de lien ou à la réception d'un mail ( adresse avec VERP). Pour fournir la fonctionnalité, il semble faisable d'utiliser des liens mailto, tel que décrit dans <a href="https://www.rfc-editor.org/rfc/rfc6068">RFC 6068</a>.</p>
<p>Cette RFC précise d'ailleurs dans son point 4 qu'on ne peut que supposer que l'utilisation des champs <code>subject</code> et <code>body</code> sera disponible. Toutefois, ceci suffit déjà pour inclure des informations dans l'un ou l'autre champ, de manière assez analogue à ce que l'on fait pour les liens que l'on inclut dans les mails.</p>
<p>Si les informations comme les sommes de contrôle sont transmises, il devient alors possible de les vérifier (éventuellement via des formulaires à développer) avant qu'un utilisateur de Civiparoisse effectue les actions demandées par un tiers.</p>
<p><strong>Dans le cadre de cette fonctionnalité, il faudrait donc développer deux catégories d'éléments :</strong></p>
<ul>
<li><strong>la génération des URL mailto adéquates</strong></li>
<li><strong>les formulaires (admin) de vérification des données</strong></li>
</ul>
<h2 id="elements-hypothetiquement-utiles-pour-le-futur">Eléments hypothétiquement utiles pour le futur</h2>
<p>Deux types d'éléments pourraient être intéressants pour le futur :</p>
<ul>
<li>la possibilité d'utiliser SMIME pour chiffrer les messages envoyés, en utilisant la clef publique du destinataire</li>
<li>la possibilité d'utiliser SMIME pour signer les messages envoyés, pour que les destinataires puissent vérifier l'authenticité des messages.</li>
</ul>
<p>Ces deux éléments supposent toutefois des connaissances et une sensibilisation poussées dont ne disposent pas actuellement la plupart des utilisateurs.</p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="mail.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Index" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Index
            </div>
          </div>
        </a>
      
      
        
        <a href="sendmail.html" class="md-footer__link md-footer__link--next" aria-label="Next: Envoi" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Envoi
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["search.suggest", "search.highlight", "navigation.sections"], "search": "../../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.5a2dcb6a.min.js"></script>
      
    
    
  </body>
</html>